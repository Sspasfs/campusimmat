<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="fr">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.10.0"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>CampusImmat: Swaggest JSON-schema implementation for PHP</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<script type="text/javascript" src="clipboard.js"></script>
<script type="text/javascript" src="cookie.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">CampusImmat
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Généré par Doxygen 1.10.0 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Recherche');
  $(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Chargement...</div>
<div class="SRStatus" id="Searching">Recherche...</div>
<div class="SRStatus" id="NoMatches">Aucune correspondance</div>
</div>
</div>
</div>
</div>

</div><!-- top -->
<div><div class="header">
  <div class="headertitle"><div class="title">Swaggest JSON-schema implementation for PHP</div></div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p><a class="anchor" id="autotoc_md7329"></a> <a href="https://travis-ci.org/swaggest/php-json-schema"><img src="https://travis-ci.org/swaggest/php-json-schema.svg?branch=master" alt="Build Status" style="pointer-events: none;" class="inline"/></a> <a href="https://codecov.io/gh/swaggest/php-json-schema"><img src="https://codecov.io/gh/swaggest/php-json-schema/branch/master/graph/badge.svg" alt="codecov" style="pointer-events: none;" class="inline"/></a> <a href="https://wakatime.com/badge/github/swaggest/php-json-schema"><img src="https://wakatime.com/badge/github/swaggest/php-json-schema.svg" alt="time tracker" style="pointer-events: none;" class="inline"/></a> <img src="https://sloc.xyz/github/swaggest/php-json-schema/?category=code" alt="Code lines" class="inline"/> <img src="https://sloc.xyz/github/swaggest/php-json-schema/?category=comments" alt="Comments" class="inline"/></p>
<p>High definition PHP structures with JSON-schema based validation.</p>
<p>Supported schemas:</p>
<ul>
<li><a href="http://json-schema.org/specification-links.html#draft-7">JSON Schema Draft 7</a></li>
<li><a href="http://json-schema.org/specification-links.html#draft-6">JSON Schema Draft 6</a></li>
<li><a href="http://json-schema.org/specification-links.html#draft-4">JSON Schema Draft 4</a></li>
</ul>
<h1><a class="anchor" id="autotoc_md7330"></a>
Installation</h1>
<div class="fragment"><div class="line">composer require swaggest/json-schema</div>
</div><!-- fragment --><h1><a class="anchor" id="autotoc_md7331"></a>
Usage</h1>
<p>Structure definition can be done either with <code>json-schema</code> or with <code>PHP</code> class extending <code><a class="el" href="namespace_swaggest.html">Swaggest</a>\JsonSchema\Structure\ClassStructure</code></p>
<h2><a class="anchor" id="autotoc_md7332"></a>
Validating JSON data against given schema</h2>
<p>Define your json-schema</p>
<div class="fragment"><div class="line"><a class="code hl_variable" href="report_8contract_8php.html#a77b973d137fb33212e018b042df6e3e7">$schemaJson</a> = &lt;&lt;&lt;<span class="stringliteral">&#39;JSON&#39;</span></div>
<div class="line">{</div>
<div class="line">    <span class="stringliteral">&quot;type&quot;</span>: <span class="stringliteral">&quot;object&quot;</span>,</div>
<div class="line">    <span class="stringliteral">&quot;properties&quot;</span>: {</div>
<div class="line">        <span class="stringliteral">&quot;id&quot;</span>: {</div>
<div class="line">            <span class="stringliteral">&quot;type&quot;</span>: <span class="stringliteral">&quot;integer&quot;</span></div>
<div class="line">        },</div>
<div class="line">        <span class="stringliteral">&quot;name&quot;</span>: {</div>
<div class="line">            <span class="stringliteral">&quot;type&quot;</span>: <span class="stringliteral">&quot;string&quot;</span></div>
<div class="line">        },</div>
<div class="line">        <span class="stringliteral">&quot;orders&quot;</span>: {</div>
<div class="line">            <span class="stringliteral">&quot;type&quot;</span>: <span class="stringliteral">&quot;array&quot;</span>,</div>
<div class="line">            <span class="stringliteral">&quot;items&quot;</span>: {</div>
<div class="line">                <span class="stringliteral">&quot;$ref&quot;</span>: <span class="stringliteral">&quot;#/definitions/order&quot;</span></div>
<div class="line">            }</div>
<div class="line">        }</div>
<div class="line">    },</div>
<div class="line">    <span class="stringliteral">&quot;required&quot;</span>:[<span class="stringliteral">&quot;id&quot;</span>],</div>
<div class="line">    <span class="stringliteral">&quot;definitions&quot;</span>: {</div>
<div class="line">        <span class="stringliteral">&quot;order&quot;</span>: {</div>
<div class="line">            <span class="stringliteral">&quot;type&quot;</span>: <span class="stringliteral">&quot;object&quot;</span>,</div>
<div class="line">            <span class="stringliteral">&quot;properties&quot;</span>: {</div>
<div class="line">                <span class="stringliteral">&quot;id&quot;</span>: {</div>
<div class="line">                    <span class="stringliteral">&quot;type&quot;</span>: <span class="stringliteral">&quot;integer&quot;</span></div>
<div class="line">                },</div>
<div class="line">                <span class="stringliteral">&quot;price&quot;</span>: {</div>
<div class="line">                    <span class="stringliteral">&quot;type&quot;</span>: <span class="stringliteral">&quot;number&quot;</span></div>
<div class="line">                },</div>
<div class="line">                <span class="stringliteral">&quot;updated&quot;</span>: {</div>
<div class="line">                    <span class="stringliteral">&quot;type&quot;</span>: <span class="stringliteral">&quot;string&quot;</span>,</div>
<div class="line">                    <span class="stringliteral">&quot;format&quot;</span>: <span class="stringliteral">&quot;date-time&quot;</span></div>
<div class="line">                }</div>
<div class="line">            },</div>
<div class="line">            <span class="stringliteral">&quot;required&quot;</span>:[<span class="stringliteral">&quot;id&quot;</span>]</div>
<div class="line">        }</div>
<div class="line">    }</div>
<div class="line">}</div>
<div class="line">JSON;</div>
<div class="ttc" id="areport_8contract_8php_html_a77b973d137fb33212e018b042df6e3e7"><div class="ttname"><a href="report_8contract_8php.html#a77b973d137fb33212e018b042df6e3e7">$y</a></div><div class="ttdeci">$y</div><div class="ttdef"><b>Definition</b> report.contract.php:71</div></div>
</div><!-- fragment --><p>Load it</p>
<div class="fragment"><div class="line"><a class="code hl_variable" href="report_8contract_8php.html#a77b973d137fb33212e018b042df6e3e7">use</a> <a class="code hl_class" href="class_swaggest_1_1_json_schema_1_1_schema.html">Swaggest\JsonSchema\Schema</a>;</div>
<div class="line">$schema = Schema::import(json_decode(<a class="code hl_variable" href="report_8contract_8php.html#a77b973d137fb33212e018b042df6e3e7">$schemaJson</a>));</div>
<div class="ttc" id="aclass_swaggest_1_1_json_schema_1_1_schema_html"><div class="ttname"><a href="class_swaggest_1_1_json_schema_1_1_schema.html">Swaggest\JsonSchema\Schema</a></div><div class="ttdef"><b>Definition</b> Schema.php:35</div></div>
</div><!-- fragment --><p>Validate data</p>
<div class="fragment"><div class="line">$schema-&gt;in(json_decode(&lt;&lt;&lt;<span class="stringliteral">&#39;JSON&#39;</span></div>
<div class="line">{</div>
<div class="line">    <span class="stringliteral">&quot;id&quot;</span>: 1,</div>
<div class="line">    <span class="stringliteral">&quot;name&quot;</span>:<span class="stringliteral">&quot;John Doe&quot;</span>,</div>
<div class="line">    <span class="stringliteral">&quot;orders&quot;</span>:[</div>
<div class="line">        {</div>
<div class="line">            <span class="stringliteral">&quot;id&quot;</span>:1</div>
<div class="line">        },</div>
<div class="line">        {</div>
<div class="line">            <span class="stringliteral">&quot;price&quot;</span>:1.0</div>
<div class="line">        }</div>
<div class="line">    ]</div>
<div class="line">}</div>
<div class="line">JSON</div>
<div class="line">)); <span class="comment">// Exception: Required property missing: id at #-&gt;properties:orders-&gt;items[1]-&gt;#/definitions/order</span></div>
</div><!-- fragment --><p>You can also call <code>Schema::import</code> on string <code>uri</code> to schema json data.</p>
<div class="fragment"><div class="line">$schema = Schema::import(<span class="stringliteral">&#39;http://localhost:1234/my_schema.json&#39;</span>);</div>
</div><!-- fragment --><p>Or with boolean argument.</p>
<div class="fragment"><div class="line">$schema = Schema::import(<span class="keyword">true</span>); <span class="comment">// permissive schema, always validates</span></div>
<div class="line">$schema = Schema::import(<span class="keyword">false</span>); <span class="comment">// restrictive schema, always invalidates</span></div>
</div><!-- fragment --><h2><a class="anchor" id="autotoc_md7333"></a>
Understanding error cause</h2>
<p>With complex schemas it may be hard to find out what's wrong with your data. Exception message can look like:</p>
<div class="fragment"><div class="line">No valid results for oneOf {</div>
<div class="line"> 0: Enum failed, enum: [&quot;a&quot;], data: &quot;f&quot; at #-&gt;properties:root-&gt;patternProperties[^[a-zA-Z0-9_]+$]:zoo-&gt;oneOf[0]</div>
<div class="line"> 1: Enum failed, enum: [&quot;b&quot;], data: &quot;f&quot; at #-&gt;properties:root-&gt;patternProperties[^[a-zA-Z0-9_]+$]:zoo-&gt;oneOf[1]</div>
<div class="line"> 2: No valid results for anyOf {</div>
<div class="line">   0: Enum failed, enum: [&quot;c&quot;], data: &quot;f&quot; at #-&gt;properties:root-&gt;patternProperties[^[a-zA-Z0-9_]+$]:zoo-&gt;oneOf[2]-&gt;$ref[#/cde]-&gt;anyOf[0]</div>
<div class="line">   1: Enum failed, enum: [&quot;d&quot;], data: &quot;f&quot; at #-&gt;properties:root-&gt;patternProperties[^[a-zA-Z0-9_]+$]:zoo-&gt;oneOf[2]-&gt;$ref[#/cde]-&gt;anyOf[1]</div>
<div class="line">   2: Enum failed, enum: [&quot;e&quot;], data: &quot;f&quot; at #-&gt;properties:root-&gt;patternProperties[^[a-zA-Z0-9_]+$]:zoo-&gt;oneOf[2]-&gt;$ref[#/cde]-&gt;anyOf[2]</div>
<div class="line"> } at #-&gt;properties:root-&gt;patternProperties[^[a-zA-Z0-9_]+$]:zoo-&gt;oneOf[2]-&gt;$ref[#/cde]</div>
<div class="line">} at #-&gt;properties:root-&gt;patternProperties[^[a-zA-Z0-9_]+$]:zoo</div>
</div><!-- fragment --><p>For ambiguous schemas defined with <code>oneOf</code>/<code>anyOf</code> message is indented multi-line string.</p>
<p>Processing path is a combination of schema and data pointers. You can use <code>InvalidValue-&gt;getSchemaPointer()</code> and <code>InvalidValue-&gt;getDataPointer()</code> to extract schema/data pointer.</p>
<p>You can receive <code>Schema</code> instance that failed validation with <code>InvalidValue-&gt;getFailedSubSchema</code>.</p>
<p>You can build error tree using <code>InvalidValue-&gt;inspect()</code>.</p>
<h2><a class="anchor" id="autotoc_md7334"></a>
PHP structured classes with validation</h2>
<div class="fragment"><div class="line"> </div>
<div class="line"><span class="keyword">class </span><a class="code hl_class" href="class_user.html">User</a> <span class="keyword">extends</span> ClassStructure</div>
<div class="line">{</div>
<div class="line">    <span class="comment">/* Native (public) properties will be validated only on import and export of structure data */</span></div>
<div class="line"> </div>
<div class="line">    <span class="keyword">public</span> <a class="code hl_variable" href="dcroom__size_8php.html#a486874338c68ffaacd31e2ea5d28495f">$id</a>;</div>
<div class="line">    <span class="keyword">public</span> <a class="code hl_variable" href="aealarabiya_8php.html#ab2fc40d43824ea3e1ce5d86dee0d763b">$name</a>;</div>
<div class="line">    <span class="keyword">public</span> <a class="code hl_variable" href="report_8contract_8php.html#a77b973d137fb33212e018b042df6e3e7">$orders</a>;</div>
<div class="line"> </div>
<div class="line">    <span class="keyword">public</span> <a class="code hl_variable" href="report_8contract_8php.html#a77b973d137fb33212e018b042df6e3e7">$info</a>;</div>
<div class="line"> </div>
<div class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">function</span> setUpProperties($properties, Schema <a class="code hl_variable" href="report_8contract_8php.html#a77b973d137fb33212e018b042df6e3e7">$ownerSchema</a>)</div>
<div class="line">    {</div>
<div class="line">        <span class="comment">// You can add custom meta to your schema</span></div>
<div class="line">        <a class="code hl_variable" href="report_8contract_8php.html#a77b973d137fb33212e018b042df6e3e7">$dbTable</a> = <span class="keyword">new</span> <a class="code hl_variable" href="report_8contract_8php.html#a77b973d137fb33212e018b042df6e3e7">DbTable</a>;</div>
<div class="line">        <a class="code hl_variable" href="report_8contract_8php.html#a77b973d137fb33212e018b042df6e3e7">$dbTable</a>-&gt;tableName = <span class="stringliteral">&#39;users&#39;</span>;</div>
<div class="line">        <a class="code hl_variable" href="report_8contract_8php.html#a77b973d137fb33212e018b042df6e3e7">$ownerSchema</a>-&gt;addMeta(<a class="code hl_variable" href="report_8contract_8php.html#a77b973d137fb33212e018b042df6e3e7">$dbTable</a>);</div>
<div class="line"> </div>
<div class="line">        <span class="comment">// Setup property schemas</span></div>
<div class="line">        $properties-&gt;id = Schema::integer();</div>
<div class="line">        $properties-&gt;id-&gt;addMeta(<span class="keyword">new</span> <a class="code hl_variable" href="report_8contract_8php.html#a77b973d137fb33212e018b042df6e3e7">DbId</a>(<a class="code hl_variable" href="report_8contract_8php.html#a77b973d137fb33212e018b042df6e3e7">$dbTable</a>)); <span class="comment">// You can add meta to property.</span></div>
<div class="line"> </div>
<div class="line">        $properties-&gt;name = Schema::string();</div>
<div class="line"> </div>
<div class="line">        <span class="comment">// You can embed structures to main level with nested schemas</span></div>
<div class="line">        $properties-&gt;info = UserInfo::schema()-&gt;nested();</div>
<div class="line"> </div>
<div class="line">        <span class="comment">// You can set default value for property</span></div>
<div class="line">        $defaultOptions = <span class="keyword">new</span> <a class="code hl_variable" href="report_8contract_8php.html#a77b973d137fb33212e018b042df6e3e7">UserOptions</a>();</div>
<div class="line">        $defaultOptions-&gt;autoLogin = <span class="keyword">true</span>;</div>
<div class="line">        $defaultOptions-&gt;groupName = <span class="stringliteral">&#39;guest&#39;</span>;</div>
<div class="line">        <span class="comment">// UserOptions::schema() is safe to change as it is protected with lazy cloning</span></div>
<div class="line">        $properties-&gt;options = UserOptions::schema()-&gt;setDefault(UserOptions::export($defaultOptions));</div>
<div class="line"> </div>
<div class="line">        <span class="comment">// Dynamic (phpdoc-defined) properties can be used as well</span></div>
<div class="line">        $properties-&gt;quantity = Schema::integer();</div>
<div class="line">        $properties-&gt;quantity-&gt;minimum = 0;</div>
<div class="line"> </div>
<div class="line">        <span class="comment">// Property can be any complex structure</span></div>
<div class="line">        $properties-&gt;orders = Schema::create();</div>
<div class="line">        $properties-&gt;orders-&gt;items = Order::schema();</div>
<div class="line"> </div>
<div class="line">        <a class="code hl_variable" href="report_8contract_8php.html#a77b973d137fb33212e018b042df6e3e7">$ownerSchema</a>-&gt;required = array(self::names()-&gt;<span class="keywordtype">id</span>);</div>
<div class="line">    }</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="keyword">class </span><a class="code hl_variable" href="report_8contract_8php.html#a77b973d137fb33212e018b042df6e3e7">UserInfo</a> <span class="keyword">extends</span> ClassStructure {</div>
<div class="line">    <span class="keyword">public</span> $firstName;</div>
<div class="line">    <span class="keyword">public</span> $lastName;</div>
<div class="line">    <span class="keyword">public</span> <a class="code hl_variable" href="report_8contract_8php.html#a77b973d137fb33212e018b042df6e3e7">$birthDay</a>;</div>
<div class="line"> </div>
<div class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">function</span> setUpProperties($properties, Schema <a class="code hl_variable" href="report_8contract_8php.html#a77b973d137fb33212e018b042df6e3e7">$ownerSchema</a>)</div>
<div class="line">    {</div>
<div class="line">        $properties-&gt;firstName = Schema::string();</div>
<div class="line">        $properties-&gt;lastName = Schema::string();</div>
<div class="line">        $properties-&gt;birthDay = Schema::string();</div>
<div class="line">    }</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="keyword">class </span><a class="code hl_variable" href="report_8contract_8php.html#a77b973d137fb33212e018b042df6e3e7">UserOptions</a> <span class="keyword">extends</span> ClassStructure</div>
<div class="line">{</div>
<div class="line">    <span class="keyword">public</span> <a class="code hl_variable" href="report_8contract_8php.html#a77b973d137fb33212e018b042df6e3e7">$autoLogin</a>;</div>
<div class="line">    <span class="keyword">public</span> <a class="code hl_variable" href="report_8contract_8php.html#a77b973d137fb33212e018b042df6e3e7">$groupName</a>;</div>
<div class="line"> </div>
<div class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">function</span> setUpProperties($properties, Schema <a class="code hl_variable" href="report_8contract_8php.html#a77b973d137fb33212e018b042df6e3e7">$ownerSchema</a>)</div>
<div class="line">    {</div>
<div class="line">        $properties-&gt;autoLogin = Schema::boolean();</div>
<div class="line">        $properties-&gt;groupName = Schema::string();</div>
<div class="line">    }</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="keyword">class </span><a class="code hl_variable" href="report_8contract_8php.html#a77b973d137fb33212e018b042df6e3e7">Order</a> <span class="keyword">implements</span> ClassStructureContract</div>
<div class="line">{</div>
<div class="line">    <a class="code hl_variable" href="report_8contract_8php.html#a77b973d137fb33212e018b042df6e3e7">use</a> <a class="code hl_variable" href="namespace_swaggest_1_1_json_schema_1_1_structure.html#a26b0a120d8dafb2e9de5e6ff06c12de2">ClassStructureTrait</a>; <span class="comment">// You can use trait if you can&#39;t/don&#39;t want to extend ClassStructure</span></div>
<div class="line"> </div>
<div class="line">    <span class="keyword">const</span> <a class="code hl_variable" href="report_8contract_8php.html#a77b973d137fb33212e018b042df6e3e7">FANCY_MAPPING</a> = <span class="stringliteral">&#39;fAnCy&#39;</span>; <span class="comment">// You can create additional mapping namespace</span></div>
<div class="line"> </div>
<div class="line">    <span class="keyword">public</span> <a class="code hl_variable" href="dcroom__size_8php.html#a486874338c68ffaacd31e2ea5d28495f">$id</a>;</div>
<div class="line">    <span class="keyword">public</span> <a class="code hl_variable" href="report_8contract_8php.html#a77b973d137fb33212e018b042df6e3e7">$userId</a>;</div>
<div class="line">    <span class="keyword">public</span> <a class="code hl_variable" href="report_8contract_8php.html#a77b973d137fb33212e018b042df6e3e7">$dateTime</a>;</div>
<div class="line">    <span class="keyword">public</span> <a class="code hl_variable" href="report_8contract_8php.html#a77b973d137fb33212e018b042df6e3e7">$price</a>;</div>
<div class="line"> </div>
<div class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">function</span> setUpProperties($properties, Schema <a class="code hl_variable" href="report_8contract_8php.html#a77b973d137fb33212e018b042df6e3e7">$ownerSchema</a>)</div>
<div class="line">    {</div>
<div class="line">        <span class="comment">// Add some meta data to your schema</span></div>
<div class="line">        <a class="code hl_variable" href="report_8contract_8php.html#a77b973d137fb33212e018b042df6e3e7">$dbMeta</a> = <span class="keyword">new</span> <a class="code hl_variable" href="report_8contract_8php.html#a77b973d137fb33212e018b042df6e3e7">DbTable</a>();</div>
<div class="line">        <a class="code hl_variable" href="report_8contract_8php.html#a77b973d137fb33212e018b042df6e3e7">$dbMeta</a>-&gt;tableName = <span class="stringliteral">&#39;orders&#39;</span>;</div>
<div class="line">        <a class="code hl_variable" href="report_8contract_8php.html#a77b973d137fb33212e018b042df6e3e7">$ownerSchema</a>-&gt;addMeta(<a class="code hl_variable" href="report_8contract_8php.html#a77b973d137fb33212e018b042df6e3e7">$dbMeta</a>);</div>
<div class="line"> </div>
<div class="line">        <span class="comment">// Define properties</span></div>
<div class="line">        $properties-&gt;id = Schema::integer();</div>
<div class="line">        $properties-&gt;userId = User::properties()-&gt;id; <span class="comment">// referencing property of another schema keeps meta</span></div>
<div class="line">        $properties-&gt;dateTime = Schema::string();</div>
<div class="line">        $properties-&gt;dateTime-&gt;format = Format::DATE_TIME;</div>
<div class="line">        $properties-&gt;price = Schema::number();</div>
<div class="line"> </div>
<div class="line">        <a class="code hl_variable" href="report_8contract_8php.html#a77b973d137fb33212e018b042df6e3e7">$ownerSchema</a>-&gt;setFromRef(<span class="stringliteral">&#39;#/definitions/order&#39;</span>);</div>
<div class="line"> </div>
<div class="line">        <span class="comment">// Define default mapping if any.</span></div>
<div class="line">        <a class="code hl_variable" href="report_8contract_8php.html#a77b973d137fb33212e018b042df6e3e7">$ownerSchema</a>-&gt;addPropertyMapping(<span class="stringliteral">&#39;date_time&#39;</span>, Order::names()-&gt;<a class="code hl_variable" href="report_8contract_8php.html#a77b973d137fb33212e018b042df6e3e7">dateTime</a>);</div>
<div class="line"> </div>
<div class="line">        <span class="comment">// Use mapped name references after the default mapping was configured.</span></div>
<div class="line">        <a class="code hl_variable" href="report_8contract_8php.html#a77b973d137fb33212e018b042df6e3e7">$names</a> = self::names(<a class="code hl_variable" href="report_8contract_8php.html#a77b973d137fb33212e018b042df6e3e7">$ownerSchema</a>-&gt;properties);</div>
<div class="line">        <a class="code hl_variable" href="report_8contract_8php.html#a77b973d137fb33212e018b042df6e3e7">$ownerSchema</a>-&gt;required = array(</div>
<div class="line">            <a class="code hl_variable" href="report_8contract_8php.html#a77b973d137fb33212e018b042df6e3e7">$names</a>-&gt;id,         </div>
<div class="line">            <a class="code hl_variable" href="report_8contract_8php.html#a77b973d137fb33212e018b042df6e3e7">$names</a>-&gt;dateTime, <span class="comment">// &quot;date_time&quot;</span></div>
<div class="line">            <a class="code hl_variable" href="report_8contract_8php.html#a77b973d137fb33212e018b042df6e3e7">$names</a>-&gt;price       </div>
<div class="line">        );</div>
<div class="line"> </div>
<div class="line">        <span class="comment">// Define additional mapping</span></div>
<div class="line">        <a class="code hl_variable" href="report_8contract_8php.html#a77b973d137fb33212e018b042df6e3e7">$ownerSchema</a>-&gt;addPropertyMapping(<span class="stringliteral">&#39;DaTe_TiMe&#39;</span>, Order::names()-&gt;<a class="code hl_variable" href="report_8contract_8php.html#a77b973d137fb33212e018b042df6e3e7">dateTime</a>, self::FANCY_MAPPING);</div>
<div class="line">        <a class="code hl_variable" href="report_8contract_8php.html#a77b973d137fb33212e018b042df6e3e7">$ownerSchema</a>-&gt;addPropertyMapping(<span class="stringliteral">&#39;Id&#39;</span>, Order::names()-&gt;<span class="keywordtype">id</span>, self::FANCY_MAPPING);</div>
<div class="line">        <a class="code hl_variable" href="report_8contract_8php.html#a77b973d137fb33212e018b042df6e3e7">$ownerSchema</a>-&gt;addPropertyMapping(<span class="stringliteral">&#39;PrIcE&#39;</span>, Order::names()-&gt;<a class="code hl_variable" href="report_8contract_8php.html#a77b973d137fb33212e018b042df6e3e7">price</a>, self::FANCY_MAPPING);</div>
<div class="line">    }</div>
<div class="line">}</div>
<div class="ttc" id="aaealarabiya_8php_html_ab2fc40d43824ea3e1ce5d86dee0d763b"><div class="ttname"><a href="aealarabiya_8php.html#ab2fc40d43824ea3e1ce5d86dee0d763b">$name</a></div><div class="ttdeci">$name</div><div class="ttdef"><b>Definition</b> aealarabiya.php:4</div></div>
<div class="ttc" id="aclass_user_html"><div class="ttname"><a href="class_user.html">User</a></div><div class="ttdef"><b>Definition</b> User.php:45</div></div>
<div class="ttc" id="adcroom__size_8php_html_a486874338c68ffaacd31e2ea5d28495f"><div class="ttname"><a href="dcroom__size_8php.html#a486874338c68ffaacd31e2ea5d28495f">$id</a></div><div class="ttdeci">if(!isset($_REQUEST['id'])) $id</div><div class="ttdef"><b>Definition</b> dcroom_size.php:45</div></div>
<div class="ttc" id="anamespace_swaggest_1_1_json_schema_1_1_structure_html_a26b0a120d8dafb2e9de5e6ff06c12de2"><div class="ttname"><a href="namespace_swaggest_1_1_json_schema_1_1_structure.html#a26b0a120d8dafb2e9de5e6ff06c12de2">Swaggest\JsonSchema\Structure\ClassStructureTrait</a></div><div class="ttdeci">trait ClassStructureTrait</div><div class="ttdef"><b>Definition</b> ClassStructureTrait.php:12</div></div>
</div><!-- fragment --><p>Validation of dynamic properties is performed on set, this can help to find source of invalid data at cost of some performance drop</p>
<div class="fragment"><div class="line"><a class="code hl_variable" href="get_user_picture_8php.html#a041135b9d1519f563d0ffbfaae51f522">$user</a> = <span class="keyword">new</span> <a class="code hl_class" href="class_user.html">User</a>();</div>
<div class="line"><a class="code hl_variable" href="get_user_picture_8php.html#a041135b9d1519f563d0ffbfaae51f522">$user</a>-&gt;quantity = -1; <span class="comment">// Exception: Value more than 0 expected, -1 received</span></div>
<div class="ttc" id="aget_user_picture_8php_html_a041135b9d1519f563d0ffbfaae51f522"><div class="ttname"><a href="get_user_picture_8php.html#a041135b9d1519f563d0ffbfaae51f522">$user</a></div><div class="ttdeci">if(!isset( $_REQUEST[ 'size'])) if(!isset($_REQUEST['allow_blank'])) $user</div><div class="ttdef"><b>Definition</b> getUserPicture.php:63</div></div>
</div><!-- fragment --><p>Validation of native properties is performed only on import/export</p>
<div class="fragment"><div class="line"><a class="code hl_variable" href="get_user_picture_8php.html#a041135b9d1519f563d0ffbfaae51f522">$user</a> = <span class="keyword">new</span> <a class="code hl_class" href="class_user.html">User</a>();</div>
<div class="line"><a class="code hl_variable" href="get_user_picture_8php.html#a041135b9d1519f563d0ffbfaae51f522">$user</a>-&gt;quantity = 10;</div>
<div class="line">User::export(<a class="code hl_variable" href="get_user_picture_8php.html#a041135b9d1519f563d0ffbfaae51f522">$user</a>); <span class="comment">// Exception: Required property missing: id</span></div>
</div><!-- fragment --><p>Error messages provide a path to invalid data</p>
<div class="fragment"><div class="line"><a class="code hl_variable" href="get_user_picture_8php.html#a041135b9d1519f563d0ffbfaae51f522">$user</a> = <span class="keyword">new</span> <a class="code hl_class" href="class_user.html">User</a>();</div>
<div class="line"><a class="code hl_variable" href="get_user_picture_8php.html#a041135b9d1519f563d0ffbfaae51f522">$user</a>-&gt;id = 1;</div>
<div class="line"><a class="code hl_variable" href="get_user_picture_8php.html#a041135b9d1519f563d0ffbfaae51f522">$user</a>-&gt;name = <span class="stringliteral">&#39;John Doe&#39;</span>;</div>
<div class="line"> </div>
<div class="line"><a class="code hl_variable" href="report_8contract_8php.html#a77b973d137fb33212e018b042df6e3e7">$order</a> = <span class="keyword">new</span> <a class="code hl_variable" href="report_8contract_8php.html#a77b973d137fb33212e018b042df6e3e7">Order</a>();</div>
<div class="line"><a class="code hl_variable" href="report_8contract_8php.html#a77b973d137fb33212e018b042df6e3e7">$order</a>-&gt;dateTime = (<a class="code hl_variable" href="report_8contract_8php.html#a77b973d137fb33212e018b042df6e3e7">new \DateTime</a>())-&gt;format(<a class="code hl_variable" href="report_8contract_8php.html#a77b973d137fb33212e018b042df6e3e7">DATE_RFC3339</a>);</div>
<div class="line"><a class="code hl_variable" href="get_user_picture_8php.html#a041135b9d1519f563d0ffbfaae51f522">$user</a>-&gt;orders[] = <a class="code hl_variable" href="report_8contract_8php.html#a77b973d137fb33212e018b042df6e3e7">$order</a>;</div>
<div class="line"> </div>
<div class="line">User::export(<a class="code hl_variable" href="get_user_picture_8php.html#a041135b9d1519f563d0ffbfaae51f522">$user</a>); <span class="comment">// Exception: Required property missing: id at #-&gt;properties:orders-&gt;items[0]</span></div>
</div><!-- fragment --><h3><a class="anchor" id="autotoc_md7335"></a>
Nested structures</h3>
<p>Nested structures allow you to make composition: flatten several objects in one and separate back.</p>
<div class="fragment"><div class="line"><a class="code hl_variable" href="get_user_picture_8php.html#a041135b9d1519f563d0ffbfaae51f522">$user</a> = <span class="keyword">new</span> <a class="code hl_class" href="class_user.html">User</a>();</div>
<div class="line"><a class="code hl_variable" href="get_user_picture_8php.html#a041135b9d1519f563d0ffbfaae51f522">$user</a>-&gt;id = 1;</div>
<div class="line"> </div>
<div class="line"><a class="code hl_variable" href="report_8contract_8php.html#a77b973d137fb33212e018b042df6e3e7">$info</a> = <span class="keyword">new</span> <a class="code hl_variable" href="report_8contract_8php.html#a77b973d137fb33212e018b042df6e3e7">UserInfo</a>();</div>
<div class="line"><a class="code hl_variable" href="report_8contract_8php.html#a77b973d137fb33212e018b042df6e3e7">$info</a>-&gt;firstName = <span class="stringliteral">&#39;John&#39;</span>;</div>
<div class="line"><a class="code hl_variable" href="report_8contract_8php.html#a77b973d137fb33212e018b042df6e3e7">$info</a>-&gt;lastName = <span class="stringliteral">&#39;Doe&#39;</span>;</div>
<div class="line"><a class="code hl_variable" href="report_8contract_8php.html#a77b973d137fb33212e018b042df6e3e7">$info</a>-&gt;birthDay = <span class="stringliteral">&#39;1970-01-01&#39;</span>;</div>
<div class="line"><a class="code hl_variable" href="get_user_picture_8php.html#a041135b9d1519f563d0ffbfaae51f522">$user</a>-&gt;info = <a class="code hl_variable" href="report_8contract_8php.html#a77b973d137fb33212e018b042df6e3e7">$info</a>;</div>
<div class="line"> </div>
<div class="line">$json = &lt;&lt;&lt;JSON</div>
<div class="line">{</div>
<div class="line">    <span class="stringliteral">&quot;id&quot;</span>: 1,</div>
<div class="line">    <span class="stringliteral">&quot;firstName&quot;</span>: <span class="stringliteral">&quot;John&quot;</span>,</div>
<div class="line">    <span class="stringliteral">&quot;lastName&quot;</span>: <span class="stringliteral">&quot;Doe&quot;</span>,</div>
<div class="line">    <span class="stringliteral">&quot;birthDay&quot;</span>: <span class="stringliteral">&quot;1970-01-01&quot;</span></div>
<div class="line">}</div>
<div class="line">JSON;</div>
<div class="line"><a class="code hl_variable" href="report_8contract_8php.html#a77b973d137fb33212e018b042df6e3e7">$exported</a> = User::export(<a class="code hl_variable" href="get_user_picture_8php.html#a041135b9d1519f563d0ffbfaae51f522">$user</a>);</div>
<div class="line">$this-&gt;<a class="code hl_variable" href="report_8contract_8php.html#a77b973d137fb33212e018b042df6e3e7">assertSame</a>($json, json_encode(<a class="code hl_variable" href="report_8contract_8php.html#a77b973d137fb33212e018b042df6e3e7">$exported</a>, <a class="code hl_variable" href="report_8contract_8php.html#a77b973d137fb33212e018b042df6e3e7">JSON_PRETTY_PRINT</a>));</div>
<div class="line"> </div>
<div class="line">$imported = User::import(json_decode($json));</div>
<div class="line">$this-&gt;<a class="code hl_variable" href="report_8contract_8php.html#a77b973d137fb33212e018b042df6e3e7">assertSame</a>(<span class="stringliteral">&#39;John&#39;</span>, $imported-&gt;info-&gt;firstName);</div>
<div class="line">$this-&gt;<a class="code hl_variable" href="report_8contract_8php.html#a77b973d137fb33212e018b042df6e3e7">assertSame</a>(<span class="stringliteral">&#39;Doe&#39;</span>, $imported-&gt;info-&gt;lastName);</div>
</div><!-- fragment --><p>You can also use <code>\<a class="el" href="namespace_swaggest.html">Swaggest</a>\JsonSchema\Structure\Composition</code> to dynamically create schema compositions. This can be helpful to deal with results of database query on joined data.</p>
<div class="fragment"><div class="line">$schema = <span class="keyword">new</span> Composition(UserInfo::schema(), Order::schema());</div>
<div class="line">$json = &lt;&lt;&lt;JSON</div>
<div class="line">{</div>
<div class="line">    <span class="stringliteral">&quot;id&quot;</span>: 1,</div>
<div class="line">    <span class="stringliteral">&quot;firstName&quot;</span>: <span class="stringliteral">&quot;John&quot;</span>,</div>
<div class="line">    <span class="stringliteral">&quot;lastName&quot;</span>: <span class="stringliteral">&quot;Doe&quot;</span>,</div>
<div class="line">    <span class="stringliteral">&quot;price&quot;</span>: 2.66</div>
<div class="line">}</div>
<div class="line">JSON;</div>
<div class="line"><a class="code hl_variable" href="report_8contract_8php.html#a77b973d137fb33212e018b042df6e3e7">$object</a> = $schema-&gt;import(json_decode($json));</div>
<div class="line"> </div>
<div class="line"><span class="comment">// Get particular object with `pick` accessor</span></div>
<div class="line"><a class="code hl_variable" href="report_8contract_8php.html#a77b973d137fb33212e018b042df6e3e7">$info</a> = UserInfo::pick(<a class="code hl_variable" href="report_8contract_8php.html#a77b973d137fb33212e018b042df6e3e7">$object</a>);</div>
<div class="line"><a class="code hl_variable" href="report_8contract_8php.html#a77b973d137fb33212e018b042df6e3e7">$order</a> = Order::pick(<a class="code hl_variable" href="report_8contract_8php.html#a77b973d137fb33212e018b042df6e3e7">$object</a>);</div>
<div class="line"> </div>
<div class="line"><span class="comment">// Data is imported objects of according classes</span></div>
<div class="line">$this-&gt;<a class="code hl_variable" href="report_8contract_8php.html#a77b973d137fb33212e018b042df6e3e7">assertTrue</a>(<a class="code hl_variable" href="report_8contract_8php.html#a77b973d137fb33212e018b042df6e3e7">$order</a> <a class="code hl_variable" href="report_8contract_8php.html#a77b973d137fb33212e018b042df6e3e7">instanceof</a> <a class="code hl_variable" href="report_8contract_8php.html#a77b973d137fb33212e018b042df6e3e7">Order</a>);</div>
<div class="line">$this-&gt;<a class="code hl_variable" href="report_8contract_8php.html#a77b973d137fb33212e018b042df6e3e7">assertTrue</a>(<a class="code hl_variable" href="report_8contract_8php.html#a77b973d137fb33212e018b042df6e3e7">$info</a> <a class="code hl_variable" href="report_8contract_8php.html#a77b973d137fb33212e018b042df6e3e7">instanceof</a> <a class="code hl_variable" href="report_8contract_8php.html#a77b973d137fb33212e018b042df6e3e7">UserInfo</a>);</div>
<div class="line"> </div>
<div class="line">$this-&gt;<a class="code hl_variable" href="report_8contract_8php.html#a77b973d137fb33212e018b042df6e3e7">assertSame</a>(1, <a class="code hl_variable" href="report_8contract_8php.html#a77b973d137fb33212e018b042df6e3e7">$order</a>-&gt;id);</div>
<div class="line">$this-&gt;<a class="code hl_variable" href="report_8contract_8php.html#a77b973d137fb33212e018b042df6e3e7">assertSame</a>(<span class="stringliteral">&#39;John&#39;</span>, <a class="code hl_variable" href="report_8contract_8php.html#a77b973d137fb33212e018b042df6e3e7">$info</a>-&gt;firstName);</div>
<div class="line">$this-&gt;<a class="code hl_variable" href="report_8contract_8php.html#a77b973d137fb33212e018b042df6e3e7">assertSame</a>(<span class="stringliteral">&#39;Doe&#39;</span>, <a class="code hl_variable" href="report_8contract_8php.html#a77b973d137fb33212e018b042df6e3e7">$info</a>-&gt;lastName);</div>
<div class="line">$this-&gt;<a class="code hl_variable" href="report_8contract_8php.html#a77b973d137fb33212e018b042df6e3e7">assertSame</a>(2.66, <a class="code hl_variable" href="report_8contract_8php.html#a77b973d137fb33212e018b042df6e3e7">$order</a>-&gt;price);</div>
</div><!-- fragment --><h3><a class="anchor" id="autotoc_md7336"></a>
Keys mapping</h3>
<p>If property names of PHP objects should be different from raw data you can call <code>-&gt;addPropertyMapping</code> on owner schema.</p>
<div class="fragment"><div class="line"><span class="comment">// Define default mapping if any</span></div>
<div class="line">$ownerSchema-&gt;addPropertyMapping(<span class="stringliteral">&#39;date_time&#39;</span>, Order::names()-&gt;<a class="code hl_variable" href="report_8contract_8php.html#a77b973d137fb33212e018b042df6e3e7">dateTime</a>);</div>
<div class="line"> </div>
<div class="line"><span class="comment">// Define additional mapping</span></div>
<div class="line"><a class="code hl_variable" href="report_8contract_8php.html#a77b973d137fb33212e018b042df6e3e7">$ownerSchema</a>-&gt;addPropertyMapping(<span class="stringliteral">&#39;DaTe_TiMe&#39;</span>, Order::names()-&gt;<a class="code hl_variable" href="report_8contract_8php.html#a77b973d137fb33212e018b042df6e3e7">dateTime</a>, self::FANCY_MAPPING);</div>
<div class="line"><a class="code hl_variable" href="report_8contract_8php.html#a77b973d137fb33212e018b042df6e3e7">$ownerSchema</a>-&gt;addPropertyMapping(<span class="stringliteral">&#39;Id&#39;</span>, Order::names()-&gt;<span class="keywordtype">id</span>, self::FANCY_MAPPING);</div>
<div class="line"><a class="code hl_variable" href="report_8contract_8php.html#a77b973d137fb33212e018b042df6e3e7">$ownerSchema</a>-&gt;addPropertyMapping(<span class="stringliteral">&#39;PrIcE&#39;</span>, Order::names()-&gt;<a class="code hl_variable" href="report_8contract_8php.html#a77b973d137fb33212e018b042df6e3e7">price</a>, self::FANCY_MAPPING);</div>
</div><!-- fragment --><p>It will affect data mapping:</p>
<div class="fragment"><div class="line"><a class="code hl_variable" href="report_8contract_8php.html#a77b973d137fb33212e018b042df6e3e7">$order</a> = <span class="keyword">new</span> <a class="code hl_variable" href="report_8contract_8php.html#a77b973d137fb33212e018b042df6e3e7">Order</a>();</div>
<div class="line"><a class="code hl_variable" href="report_8contract_8php.html#a77b973d137fb33212e018b042df6e3e7">$order</a>-&gt;id = 1;</div>
<div class="line"><a class="code hl_variable" href="report_8contract_8php.html#a77b973d137fb33212e018b042df6e3e7">$order</a>-&gt;dateTime = <span class="stringliteral">&#39;2015-10-28T07:28:00Z&#39;</span>;</div>
<div class="line"><a class="code hl_variable" href="report_8contract_8php.html#a77b973d137fb33212e018b042df6e3e7">$order</a>-&gt;price = 2.2;</div>
<div class="line"><a class="code hl_variable" href="report_8contract_8php.html#a77b973d137fb33212e018b042df6e3e7">$exported</a> = Order::export(<a class="code hl_variable" href="report_8contract_8php.html#a77b973d137fb33212e018b042df6e3e7">$order</a>);</div>
<div class="line">$json = &lt;&lt;&lt;JSON</div>
<div class="line">{</div>
<div class="line">    <span class="stringliteral">&quot;id&quot;</span>: 1,</div>
<div class="line">    <span class="stringliteral">&quot;date_time&quot;</span>: <span class="stringliteral">&quot;2015-10-28T07:28:00Z&quot;</span>,</div>
<div class="line">    <span class="stringliteral">&quot;price&quot;</span>: 2.2</div>
<div class="line">}</div>
<div class="line">JSON;</div>
<div class="line">$this-&gt;<a class="code hl_variable" href="report_8contract_8php.html#a77b973d137fb33212e018b042df6e3e7">assertSame</a>($json, json_encode(<a class="code hl_variable" href="report_8contract_8php.html#a77b973d137fb33212e018b042df6e3e7">$exported</a>, <a class="code hl_variable" href="report_8contract_8php.html#a77b973d137fb33212e018b042df6e3e7">JSON_PRETTY_PRINT</a>));</div>
<div class="line"> </div>
<div class="line">$imported = Order::import(json_decode($json));</div>
<div class="line">$this-&gt;<a class="code hl_variable" href="report_8contract_8php.html#a77b973d137fb33212e018b042df6e3e7">assertSame</a>(<span class="stringliteral">&#39;2015-10-28T07:28:00Z&#39;</span>, $imported-&gt;dateTime);</div>
</div><!-- fragment --><p>You can have multiple mapping namespaces, controlling with <code>mapping</code> property of <code>Context</code></p>
<div class="fragment"><div class="line"><a class="code hl_variable" href="common_8tabs_8php.html#a011800c63ece4cbbfa77136a20607023">$options</a> = <span class="keyword">new</span> Context();</div>
<div class="line"><a class="code hl_variable" href="common_8tabs_8php.html#a011800c63ece4cbbfa77136a20607023">$options</a>-&gt;mapping = Order::FANCY_MAPPING;</div>
<div class="line"> </div>
<div class="line"><a class="code hl_variable" href="report_8contract_8php.html#a77b973d137fb33212e018b042df6e3e7">$exported</a> = Order::export(<a class="code hl_variable" href="report_8contract_8php.html#a77b973d137fb33212e018b042df6e3e7">$order</a>, <a class="code hl_variable" href="common_8tabs_8php.html#a011800c63ece4cbbfa77136a20607023">$options</a>);</div>
<div class="line">$json = &lt;&lt;&lt;JSON</div>
<div class="line">{</div>
<div class="line">    <span class="stringliteral">&quot;Id&quot;</span>: 1,</div>
<div class="line">    <span class="stringliteral">&quot;DaTe_TiMe&quot;</span>: <span class="stringliteral">&quot;2015-10-28T07:28:00Z&quot;</span>,</div>
<div class="line">    <span class="stringliteral">&quot;PrIcE&quot;</span>: 2.2</div>
<div class="line">}</div>
<div class="line">JSON;</div>
<div class="line">$this-&gt;<a class="code hl_variable" href="report_8contract_8php.html#a77b973d137fb33212e018b042df6e3e7">assertSame</a>($json, json_encode(<a class="code hl_variable" href="report_8contract_8php.html#a77b973d137fb33212e018b042df6e3e7">$exported</a>, <a class="code hl_variable" href="report_8contract_8php.html#a77b973d137fb33212e018b042df6e3e7">JSON_PRETTY_PRINT</a>));</div>
<div class="line"> </div>
<div class="line">$imported = Order::import(json_decode($json), <a class="code hl_variable" href="common_8tabs_8php.html#a011800c63ece4cbbfa77136a20607023">$options</a>);</div>
<div class="line">$this-&gt;<a class="code hl_variable" href="report_8contract_8php.html#a77b973d137fb33212e018b042df6e3e7">assertSame</a>(<span class="stringliteral">&#39;2015-10-28T07:28:00Z&#39;</span>, $imported-&gt;dateTime);</div>
<div class="ttc" id="acommon_8tabs_8php_html_a011800c63ece4cbbfa77136a20607023"><div class="ttname"><a href="common_8tabs_8php.html#a011800c63ece4cbbfa77136a20607023">$options</a></div><div class="ttdeci">$options</div><div class="ttdef"><b>Definition</b> common.tabs.php:109</div></div>
</div><!-- fragment --><p>You can create your own pre-processor implementing <code><a class="el" href="namespace_swaggest.html">Swaggest</a>\JsonSchema\DataPreProcessor</code>.</p>
<h3><a class="anchor" id="autotoc_md7337"></a>
Meta</h3>
<p><code>Meta</code> is a way to complement <code>Schema</code> with your own data. You can keep and retrieve it.</p>
<p>You can store it.</p>
<div class="fragment"><div class="line"><a class="code hl_variable" href="report_8contract_8php.html#a77b973d137fb33212e018b042df6e3e7">$dbMeta</a> = <span class="keyword">new</span> <a class="code hl_variable" href="report_8contract_8php.html#a77b973d137fb33212e018b042df6e3e7">DbTable</a>();</div>
<div class="line"><a class="code hl_variable" href="report_8contract_8php.html#a77b973d137fb33212e018b042df6e3e7">$dbMeta</a>-&gt;tableName = <span class="stringliteral">&#39;orders&#39;</span>;</div>
<div class="line"><a class="code hl_variable" href="report_8contract_8php.html#a77b973d137fb33212e018b042df6e3e7">$ownerSchema</a>-&gt;addMeta(<a class="code hl_variable" href="report_8contract_8php.html#a77b973d137fb33212e018b042df6e3e7">$dbMeta</a>);</div>
</div><!-- fragment --><p>And get back.</p>
<div class="fragment"><div class="line"><span class="comment">// Retrieving meta</span></div>
<div class="line"><a class="code hl_variable" href="report_8contract_8php.html#a77b973d137fb33212e018b042df6e3e7">$dbTable</a> = DbTable::get(Order::schema());</div>
<div class="line">$this-&gt;<a class="code hl_variable" href="report_8contract_8php.html#a77b973d137fb33212e018b042df6e3e7">assertSame</a>(<span class="stringliteral">&#39;orders&#39;</span>, <a class="code hl_variable" href="report_8contract_8php.html#a77b973d137fb33212e018b042df6e3e7">$dbTable</a>-&gt;tableName);</div>
</div><!-- fragment --><h3><a class="anchor" id="autotoc_md7338"></a>
Mapping without validation</h3>
<p>If you want to tolerate invalid data or improve mapping performance you can specify <code>skipValidation</code> flag in processing <code>Context</code></p>
<div class="fragment"><div class="line">$schema = Schema::object();</div>
<div class="line">$schema-&gt;setProperty(<span class="stringliteral">&#39;one&#39;</span>, Schema::integer());</div>
<div class="line">$schema-&gt;properties-&gt;one-&gt;minimum = 5;</div>
<div class="line"> </div>
<div class="line"><a class="code hl_variable" href="common_8tabs_8php.html#a011800c63ece4cbbfa77136a20607023">$options</a> = <span class="keyword">new</span> Context();</div>
<div class="line"><a class="code hl_variable" href="common_8tabs_8php.html#a011800c63ece4cbbfa77136a20607023">$options</a>-&gt;skipValidation = <span class="keyword">true</span>;</div>
<div class="line"> </div>
<div class="line"><a class="code hl_variable" href="front_2reservationitem_8php.html#a49a8a4009b02e49717caa88b128affc5">$res</a> = $schema-&gt;in(json_decode(<span class="stringliteral">&#39;{&quot;one&quot;:4}&#39;</span>), <a class="code hl_variable" href="common_8tabs_8php.html#a011800c63ece4cbbfa77136a20607023">$options</a>);</div>
<div class="line">$this-&gt;<a class="code hl_variable" href="report_8contract_8php.html#a77b973d137fb33212e018b042df6e3e7">assertSame</a>(4, <a class="code hl_variable" href="front_2reservationitem_8php.html#a49a8a4009b02e49717caa88b128affc5">$res</a>-&gt;one);</div>
<div class="ttc" id="afront_2reservationitem_8php_html_a49a8a4009b02e49717caa88b128affc5"><div class="ttname"><a href="front_2reservationitem_8php.html#a49a8a4009b02e49717caa88b128affc5">$res</a></div><div class="ttdeci">$res</div><div class="ttdef"><b>Definition</b> reservationitem.php:46</div></div>
</div><!-- fragment --><h3><a class="anchor" id="autotoc_md7339"></a>
Overriding mapping classes</h3>
<p>If you want to map data to a different class you can register mapping at top level of your importer structure.</p>
<div class="fragment"><div class="line"><span class="keyword">class </span><a class="code hl_variable" href="report_8contract_8php.html#a77b973d137fb33212e018b042df6e3e7">CustomSwaggerSchema</a> <span class="keyword">extends</span> <a class="code hl_variable" href="report_8contract_8php.html#a77b973d137fb33212e018b042df6e3e7">SwaggerSchema</a></div>
<div class="line">{</div>
<div class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">function</span> <span class="keyword">import</span>(<a class="code hl_variable" href="map_8php.html#ac4cc485208612884539dda2da7d39024">$data</a>, Context <a class="code hl_variable" href="common_8tabs_8php.html#a011800c63ece4cbbfa77136a20607023">$options</a> = <span class="keyword">null</span>)</div>
<div class="line">    {</div>
<div class="line">        <span class="keywordflow">if</span> (<a class="code hl_variable" href="common_8tabs_8php.html#a011800c63ece4cbbfa77136a20607023">$options</a> === <span class="keyword">null</span>) {</div>
<div class="line">            <a class="code hl_variable" href="common_8tabs_8php.html#a011800c63ece4cbbfa77136a20607023">$options</a> = <span class="keyword">new</span> Context();</div>
<div class="line">        }</div>
<div class="line">        <a class="code hl_variable" href="common_8tabs_8php.html#a011800c63ece4cbbfa77136a20607023">$options</a>-&gt;objectItemClassMapping[Schema::className()] = CustomSchema::className();</div>
<div class="line">        <span class="keywordflow">return</span> parent::import(<a class="code hl_variable" href="map_8php.html#ac4cc485208612884539dda2da7d39024">$data</a>, <a class="code hl_variable" href="common_8tabs_8php.html#a011800c63ece4cbbfa77136a20607023">$options</a>);</div>
<div class="line">    }</div>
<div class="line">}</div>
<div class="ttc" id="amap_8php_html_ac4cc485208612884539dda2da7d39024"><div class="ttname"><a href="map_8php.html#ac4cc485208612884539dda2da7d39024">$data</a></div><div class="ttdeci">$data</div><div class="ttdef"><b>Definition</b> map.php:53</div></div>
</div><!-- fragment --><p>Or specify it in processing context</p>
<div class="fragment"><div class="line"><a class="code hl_variable" href="dropdown_tracking_device_type_8php.html#ae05dedb802ada0155efdece2044fed64">$context</a> = <span class="keyword">new</span> Context();</div>
<div class="line"><a class="code hl_variable" href="dropdown_tracking_device_type_8php.html#ae05dedb802ada0155efdece2044fed64">$context</a>-&gt;objectItemClassMapping[Schema::className()] = CustomSchema::className();</div>
<div class="line">$schema = SwaggerSchema::schema()-&gt;in(json_decode(</div>
<div class="line">    file_get_contents(<a class="code hl_variable" href="report_8contract_8php.html#a77b973d137fb33212e018b042df6e3e7">__DIR__</a> . <span class="stringliteral">&#39;/../../../../spec/petstore-swagger.json&#39;</span>)</div>
<div class="line">), <a class="code hl_variable" href="dropdown_tracking_device_type_8php.html#ae05dedb802ada0155efdece2044fed64">$context</a>);</div>
<div class="line">$this-&gt;<a class="code hl_variable" href="report_8contract_8php.html#a77b973d137fb33212e018b042df6e3e7">assertInstanceOf</a>(CustomSchema::className(), $schema-&gt;definitions[<span class="stringliteral">&#39;User&#39;</span>]);</div>
<div class="ttc" id="adropdown_tracking_device_type_8php_html_ae05dedb802ada0155efdece2044fed64"><div class="ttname"><a href="dropdown_tracking_device_type_8php.html#ae05dedb802ada0155efdece2044fed64">$context</a></div><div class="ttdeci">$context</div><div class="ttdef"><b>Definition</b> dropdownTrackingDeviceType.php:48</div></div>
</div><!-- fragment --><h1><a class="anchor" id="autotoc_md7340"></a>
Code quality and test coverage</h1>
<p>Some code quality best practices are deliberately violated here ( see <a href="https://scrutinizer-ci.com/g/swaggest/php-json-schema/?branch=master"><img src="https://scrutinizer-ci.com/g/swaggest/php-json-schema/badges/quality-score.png?b=master" alt="Scrutinizer Code Quality" class="inline"/></a> ) to allow best performance at maintenance cost.</p>
<p>Those violations are secured by comprehensive test coverage:</p>
<ul>
<li>draft-04, draft-06, draft-07 of <a href="https://github.com/json-schema-org/JSON-Schema-Test-Suite">JSON-Schema-Test-Suite</a></li>
<li>test cases (excluding <code>$data</code> and few tests) of <a href="https://github.com/epoberezkin/ajv/tree/master/spec">epoberezkin/ajv</a> (a mature js implementation)</li>
</ul>
<h1><a class="anchor" id="autotoc_md7341"></a>
Contributing</h1>
<p>Issues and pull requests are welcome!</p>
<p><a href="https://sourcerer.io/fame/vearutop/swaggest/php-json-schema/links/0"><img src="https://sourcerer.io/fame/vearutop/swaggest/php-json-schema/images/0" alt="" class="inline"/></a><a href="https://sourcerer.io/fame/vearutop/swaggest/php-json-schema/links/1"><img src="https://sourcerer.io/fame/vearutop/swaggest/php-json-schema/images/1" alt="" class="inline"/></a><a href="https://sourcerer.io/fame/vearutop/swaggest/php-json-schema/links/2"><img src="https://sourcerer.io/fame/vearutop/swaggest/php-json-schema/images/2" alt="" class="inline"/></a><a href="https://sourcerer.io/fame/vearutop/swaggest/php-json-schema/links/3"><img src="https://sourcerer.io/fame/vearutop/swaggest/php-json-schema/images/3" alt="" class="inline"/></a><a href="https://sourcerer.io/fame/vearutop/swaggest/php-json-schema/links/4"><img src="https://sourcerer.io/fame/vearutop/swaggest/php-json-schema/images/4" alt="" class="inline"/></a><a href="https://sourcerer.io/fame/vearutop/swaggest/php-json-schema/links/5"><img src="https://sourcerer.io/fame/vearutop/swaggest/php-json-schema/images/5" alt="" class="inline"/></a><a href="https://sourcerer.io/fame/vearutop/swaggest/php-json-schema/links/6"><img src="https://sourcerer.io/fame/vearutop/swaggest/php-json-schema/images/6" alt="" class="inline"/></a><a href="https://sourcerer.io/fame/vearutop/swaggest/php-json-schema/links/7"><img src="https://sourcerer.io/fame/vearutop/swaggest/php-json-schema/images/7" alt="" class="inline"/></a></p>
<p>Development supported by <a href="https://www.jetbrains.com/community/opensource/#support">JetBrains</a>. </p>
</div></div><!-- contents -->
</div><!-- PageDoc -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Généré par&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.10.0
</small></address>
</body>
</html>
